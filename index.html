<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Button Party</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--tg-theme-bg-color, #1a1a2e);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 20px;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            max-width: 320px;
            width: 100%;
        }
        
        .btn {
            aspect-ratio: 1;
            border: none;
            border-radius: 16px;
            font-size: 32px;
            cursor: pointer;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .btn::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at var(--x, 50%) var(--y, 50%), 
                        rgba(255,255,255,0.4) 0%, transparent 60%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .btn:active {
            transform: scale(0.92);
        }
        
        .btn.pop {
            animation: pop 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        .btn.ripple::after {
            opacity: 1;
            animation: ripple 0.6s ease-out forwards;
        }
        
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
        }
        
        @keyframes ripple {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(2.5); opacity: 0; }
        }
        
        .btn.glow {
            box-shadow: 0 0 30px currentColor, 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        /* Fun color palette */
        .color-0 { background: linear-gradient(135deg, #ff6b6b, #ee5a5a); color: #ff6b6b; }
        .color-1 { background: linear-gradient(135deg, #4ecdc4, #3dbdb5); color: #4ecdc4; }
        .color-2 { background: linear-gradient(135deg, #ffe66d, #ffd93d); color: #ffe66d; }
        .color-3 { background: linear-gradient(135deg, #95e1d3, #7dd3c4); color: #95e1d3; }
        .color-4 { background: linear-gradient(135deg, #dda0dd, #cc8fcc); color: #dda0dd; }
        .color-5 { background: linear-gradient(135deg, #98d8c8, #88c8b8); color: #98d8c8; }
        .color-6 { background: linear-gradient(135deg, #f7dc6f, #f4d03f); color: #f7dc6f; }
        .color-7 { background: linear-gradient(135deg, #bb8fce, #a67bc2); color: #bb8fce; }
        .color-8 { background: linear-gradient(135deg, #85c1e9, #6bb3e0); color: #85c1e9; }
        .color-9 { background: linear-gradient(135deg, #f1948a, #eb7c6d); color: #f1948a; }
        .color-10 { background: linear-gradient(135deg, #82e0aa, #6ed89a); color: #82e0aa; }
        .color-11 { background: linear-gradient(135deg, #f8b500, #e5a800); color: #f8b500; }
        
        .counter {
            text-align: center;
            margin-top: 20px;
            color: var(--tg-theme-text-color, #fff);
            font-size: 18px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div>
        <div class="grid" id="grid"></div>
        <div class="counter">Taps: <span id="count">0</span></div>
    </div>

    <script>
        const icons = ['ğŸ‰', 'â­', 'ğŸ’', 'ğŸ”¥', 'ğŸ’œ', 'ğŸµ', 'âœ¨', 'ğŸŒˆ', 'ğŸ¨'];
        const altIcons = ['ğŸŠ', 'ğŸŒŸ', 'ğŸ’ ', 'ğŸŒ¶ï¸', 'ğŸ’–', 'ğŸ¶', 'ğŸ’«', 'ğŸ¦„', 'ğŸ­'];
        const numColors = 12;
        let tapCount = 0;
        
        // Initialize Telegram WebApp
        if (window.Telegram?.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
        }
        
        function haptic() {
            try {
                Telegram.WebApp.HapticFeedback.impactOccurred('light');
            } catch (e) {}
        }
        
        function createButtons() {
            const grid = document.getElementById('grid');
            
            for (let i = 0; i < 9; i++) {
                const btn = document.createElement('button');
                btn.className = `btn color-${i % numColors}`;
                btn.textContent = icons[i];
                btn.dataset.toggled = 'false';
                btn.dataset.index = i;
                
                btn.addEventListener('click', (e) => {
                    const rect = btn.getBoundingClientRect();
                    const x = ((e.clientX - rect.left) / rect.width) * 100;
                    const y = ((e.clientY - rect.top) / rect.height) * 100;
                    btn.style.setProperty('--x', x + '%');
                    btn.style.setProperty('--y', y + '%');
                    
                    // Toggle state
                    const toggled = btn.dataset.toggled === 'true';
                    btn.dataset.toggled = (!toggled).toString();
                    
                    // Change icon
                    const idx = parseInt(btn.dataset.index);
                    btn.textContent = toggled ? icons[idx] : altIcons[idx];
                    
                    // Random new color
                    const currentColor = [...btn.classList].find(c => c.startsWith('color-'));
                    let newColor;
                    do {
                        newColor = `color-${Math.floor(Math.random() * numColors)}`;
                    } while (newColor === currentColor);
                    
                    btn.classList.remove(currentColor);
                    btn.classList.add(newColor);
                    
                    // Animations
                    btn.classList.remove('pop', 'ripple', 'glow');
                    void btn.offsetWidth; // Force reflow
                    btn.classList.add('pop', 'ripple', 'glow');
                    
                    setTimeout(() => btn.classList.remove('glow'), 300);
                    setTimeout(() => btn.classList.remove('ripple'), 600);
                    
                    // Haptic
                    haptic();
                    
                    // Counter
                    tapCount++;
                    document.getElementById('count').textContent = tapCount;
                });
                
                grid.appendChild(btn);
            }
        }
        
        createButtons();
    </script>
</body>
</html>
